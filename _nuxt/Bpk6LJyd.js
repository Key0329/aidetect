import{_ as P}from"./B2yf9pKD.js";import{_ as L,f as x,c as r,a as e,g as d,h as g,v as T,i as t,j as _,F as f,k as h,l as V,m as k,n as N,d as I,t as n,p as C,b as H,w as R,o as l}from"./VVDCS1T0.js";const U={class:"perplexity-search min-h-screen bg-grayscale-100 py-8"},W={class:"container mx-auto px-4 max-w-4xl"},q={class:"bg-white rounded-12px shadow-md p-6 mb-8"},B={class:"mb-4"},D=["value"],E={class:"mb-4 p-4 bg-grayscale-50 rounded-8px"},F={class:"flex items-center mb-3"},K={key:0,class:"ml-6"},j={class:"flex flex-col md:flex-row gap-4"},z={class:"w-full"},J=["disabled"],Q={class:"flex gap-2"},$=["disabled"],G={key:0,class:"animate-spin"},X={key:0,class:"mt-4 p-4 bg-red-50 border border-red-200 rounded-8px"},Y={class:"text-red-600 text-14px"},Z={key:0,class:"bg-white rounded-12px shadow-md p-8 text-center"},ee={key:1,class:"bg-white rounded-12px shadow-md p-6"},se={class:"border-b border-grayscale-200 pb-4 mb-6"},te={class:"flex flex-wrap gap-4 text-14px text-grayscale-500"},ae={key:0},oe={class:"mb-6"},re={key:0,class:"mb-6"},le={class:"prose max-w-none mb-4"},ne=["innerHTML"],de={class:"text-12px text-grayscale-500 mb-4"},ie={class:"mb-4"},ce={class:"p-4 bg-grayscale-50 rounded-8px border"},pe=["innerHTML"],xe={key:1},ue={class:"prose max-w-none"},me=["innerHTML"],ye={key:2,class:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-8px"},be={class:"text-yellow-700 text-14px"},ge={key:0,class:"mb-6"},_e={class:"grid gap-3"},ve=["href"],fe={key:1,class:"mb-6"},he={class:"grid gap-4"},we={class:"font-medium text-grayscale-600 mb-2"},ke=["href"],Ie={key:0,class:"text-12px text-grayscale-400"},Ae={class:"border-t border-grayscale-200 pt-4"},Oe={class:"text-14px"},Se={class:"mt-3 p-3 bg-grayscale-50 rounded-6px"},Me={class:"text-12px text-grayscale-600 whitespace-pre-wrap overflow-auto"},Pe={class:"text-center mt-8"},Le={__name:"per",setup(Te){const p=x(""),a=x(null),i=x(!1),u=x(""),y=x("sonar"),m=x(!1),b=x("請將以下內容進行整理和總結，讓它更加簡潔明了："),A=[{value:"sonar",label:"Sonar"},{value:"sonar-pro",label:"Sonar Pro"},{value:"sonar-reasoning",label:"Sonar Reasoning"},{value:"sonar-reasoning-pro",label:"Sonar Reasoning Pro"}],w=async()=>{if(!p.value.trim()){u.value="請輸入搜尋查詢";return}i.value=!0,u.value="",a.value=null;try{const c=await $fetch("/api/perplexity/search",{method:"POST",body:{query:p.value,model:y.value,refineWithOpenAI:m.value,refinePrompt:b.value}});a.value=c}catch(c){u.value=c?.data?.message||c?.message||"搜尋時發生錯誤",console.error("Search error:",c)}finally{i.value=!1}},O=()=>{a.value=null,u.value=""},S=c=>{c.key==="Enter"&&!i.value&&w()};return(c,s)=>{const M=P;return l(),r("div",U,[e("div",W,[s[17]||(s[17]=e("div",{class:"text-center mb-8"},[e("h1",{class:"text-32px font-bold text-grayscale-600 mb-4"}," Perplexity AI 搜尋 "),e("p",{class:"text-16px text-grayscale-500"}," 使用 Perplexity AI 進行智能搜尋，獲得準確且有引用來源的答案 ")],-1)),e("div",q,[e("div",B,[s[4]||(s[4]=e("label",{class:"block text-14px font-medium text-grayscale-600 mb-2"}," 選擇模型 ",-1)),g(e("select",{"onUpdate:modelValue":s[0]||(s[0]=o=>_(y)?y.value=o:null),class:"w-full md:w-auto px-3 py-2 border border-grayscale-300 rounded-6px focus:outline-none focus:ring-2 focus:ring-secondary-200"},[(l(),r(f,null,h(A,o=>e("option",{key:o.value,value:o.value},n(o.label),9,D)),64))],512),[[T,t(y)]])]),e("div",E,[e("div",F,[g(e("input",{id:"refineWithOpenAI","onUpdate:modelValue":s[1]||(s[1]=o=>_(m)?m.value=o:null),type:"checkbox",class:"mr-2 h-4 w-4 text-secondary-200 focus:ring-secondary-200 border-grayscale-300 rounded"},null,512),[[V,t(m)]]),s[5]||(s[5]=e("label",{for:"refineWithOpenAI",class:"text-14px font-medium text-grayscale-600"}," 啟用 OpenAI 內容整理 ",-1))]),t(m)?(l(),r("div",K,[s[6]||(s[6]=e("label",{class:"block text-14px font-medium text-grayscale-600 mb-2"}," 整理指令 ",-1)),g(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=o=>_(b)?b.value=o:null),rows:"3",class:"w-full px-3 py-2 border border-grayscale-300 rounded-6px focus:outline-none focus:ring-2 focus:ring-secondary-200 text-14px",placeholder:"請輸入希望 OpenAI 如何整理內容的指令..."},null,512),[[k,t(b)]]),s[7]||(s[7]=e("p",{class:"text-12px text-grayscale-500 mt-1"}," 啟用後，Perplexity 回應將透過 OpenAI 進行進一步整理和優化 ",-1))])):d("",!0)]),e("div",j,[e("div",z,[g(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>_(p)?p.value=o:null),type:"text",placeholder:"請輸入您的搜尋查詢...",class:"w-full px-4 py-3 border border-grayscale-300 rounded-8px focus:outline-none focus:ring-2 focus:ring-secondary-200 text-16px",disabled:t(i),onKeypress:S},null,40,J),[[k,t(p)]])]),e("div",Q,[e("button",{disabled:t(i)||!t(p).trim(),class:N(["button-primary-md flex items-center gap-2 whitespace-nowrap",{"opacity-50 cursor-not-allowed":t(i)||!t(p).trim()}]),onClick:w},[t(i)?(l(),r("span",G,"⏳")):d("",!0),I(" "+n(t(i)?"搜尋中...":"搜尋"),1)],10,$),t(a)?(l(),r("button",{key:0,class:"button-secondary-md",onClick:O}," 清除 ")):d("",!0)])]),t(u)?(l(),r("div",X,[e("p",Y,n(t(u)),1)])):d("",!0)]),t(i)?(l(),r("div",Z,[...s[8]||(s[8]=[C('<div class="animate-pulse" data-v-f2071f84><div class="h-4 bg-grayscale-200 rounded mb-4" data-v-f2071f84></div><div class="h-4 bg-grayscale-200 rounded mb-4 w-3/4 mx-auto" data-v-f2071f84></div><div class="h-4 bg-grayscale-200 rounded w-1/2 mx-auto" data-v-f2071f84></div></div><p class="text-grayscale-500 mt-4" data-v-f2071f84>正在使用 AI 搜尋相關資訊...</p>',2)])])):d("",!0),t(a)&&!t(i)?(l(),r("div",ee,[e("div",se,[s[9]||(s[9]=e("h2",{class:"text-20px font-bold text-grayscale-600 mb-2"},"搜尋結果",-1)),e("div",te,[e("span",null,"模型: "+n(t(a).model),1),e("span",null,"用量: "+n(t(a).usage?.total_tokens)+" tokens",1),t(a).usage?.num_search_queries?(l(),r("span",ae," 搜尋次數: "+n(t(a).usage.num_search_queries),1)):d("",!0)])]),e("div",oe,[t(a).is_refined?(l(),r("div",re,[s[11]||(s[11]=e("h3",{class:"text-18px font-semibold text-grayscale-600 mb-3 flex items-center"},[e("span",{class:"mr-2"},"✨ OpenAI 整理後內容"),e("span",{class:"text-12px bg-secondary-100 text-secondary-600 px-2 py-1 rounded-full"}," 已優化 ")],-1)),e("div",le,[e("div",{class:"text-16px leading-28px text-grayscale-600 whitespace-pre-wrap p-4 bg-gradient-to-r from-secondary-50 to-blue-50 rounded-8px border border-secondary-100",innerHTML:t(a).refined_content?.replace(/\n/g,"<br>")||""},null,8,ne)]),e("div",de," OpenAI 處理用量: "+n(t(a).openai_tokens_used)+" tokens ",1),e("details",ie,[s[10]||(s[10]=e("summary",{class:"cursor-pointer text-14px text-grayscale-500 hover:text-grayscale-600 mb-2"}," 查看原始 Perplexity 回應 ",-1)),e("div",ce,[e("div",{class:"text-14px leading-24px text-grayscale-600 whitespace-pre-wrap",innerHTML:t(a).choices?.[0]?.message?.content?.replace(/\n/g,"<br>")||""},null,8,pe)])])])):(l(),r("div",xe,[s[12]||(s[12]=e("h3",{class:"text-18px font-semibold text-grayscale-600 mb-3"}," AI 回應 ",-1)),e("div",ue,[e("div",{class:"text-16px leading-28px text-grayscale-600 whitespace-pre-wrap",innerHTML:t(a).choices?.[0]?.message?.content?.replace(/\n/g,"<br>")||""},null,8,me)])])),t(a).refine_error?(l(),r("div",ye,[e("p",be," ⚠️ "+n(t(a).refine_error),1)])):d("",!0)]),t(a).citations&&t(a).citations.length>0?(l(),r("div",ge,[s[13]||(s[13]=e("h3",{class:"text-18px font-semibold text-grayscale-600 mb-3"}," 引用來源 ",-1)),e("div",_e,[(l(!0),r(f,null,h(t(a).citations,(o,v)=>(l(),r("div",{key:v,class:"p-3 bg-grayscale-100 rounded-8px"},[e("a",{href:o,target:"_blank",rel:"noopener noreferrer",class:"text-secondary-200 hover:text-secondary-100 text-14px break-all"},n(o),9,ve)]))),128))])])):d("",!0),t(a).search_results&&t(a).search_results.length>0?(l(),r("div",fe,[s[14]||(s[14]=e("h3",{class:"text-18px font-semibold text-grayscale-600 mb-3"}," 相關搜尋結果 ",-1)),e("div",he,[(l(!0),r(f,null,h(t(a).search_results,(o,v)=>(l(),r("div",{key:v,class:"p-4 border border-grayscale-200 rounded-8px hover:shadow-sm transition-shadow"},[e("h4",we,n(o.title),1),e("a",{href:o.url,target:"_blank",rel:"noopener noreferrer",class:"text-secondary-200 hover:text-secondary-100 text-14px break-all mb-1 block"},n(o.url),9,ke),o.date?(l(),r("p",Ie,n(o.date),1)):d("",!0)]))),128))])])):d("",!0),e("div",Ae,[e("details",Oe,[s[15]||(s[15]=e("summary",{class:"cursor-pointer text-grayscale-500 hover:text-grayscale-600"}," 詳細資訊 ",-1)),e("div",Se,[e("pre",Me,n(JSON.stringify(t(a),null,2)),1)])])])])):d("",!0),e("div",Pe,[H(M,{to:"/",class:"text-secondary-200 hover:text-secondary-100 text-16px"},{default:R(()=>[...s[16]||(s[16]=[I(" ← 返回首頁 ",-1)])]),_:1})])])])}}},Ce=L(Le,[["__scopeId","data-v-f2071f84"]]);export{Ce as default};
