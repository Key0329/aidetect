import{_ as B}from"./BXWtCiK-.js";import{_ as D,f as p,c as r,a as e,g as d,h as _,v as E,u as t,i as g,F as f,j as h,k as F,l as C,n as K,d as H,t as n,m as j,b as z,w as J,o as l}from"./UalXc_oF.js";const Q={class:"perplexity-search min-h-screen bg-grayscale-100 py-8"},$={class:"container mx-auto px-4 max-w-4xl"},G={class:"bg-white rounded-12px shadow-md p-6 mb-8"},X={class:"mb-4"},Y=["value"],Z={class:"mb-4 p-4 bg-grayscale-50 rounded-8px"},ee={class:"flex items-center mb-3"},se={key:0,class:"ml-6"},te={class:"flex flex-col md:flex-row gap-4"},ae={class:"w-full"},oe=["disabled"],re={class:"flex gap-2"},le=["disabled"],ne={key:0,class:"animate-spin"},de={key:0,class:"mt-4 p-4 bg-red-50 border border-red-200 rounded-8px"},ie={class:"text-red-600 text-14px"},ce={key:0,class:"bg-white rounded-12px shadow-md p-8 text-center"},pe={key:1,class:"bg-white rounded-12px shadow-md p-6"},ue={class:"border-b border-grayscale-200 pb-4 mb-6"},xe={class:"flex flex-wrap gap-4 text-14px text-grayscale-500"},me={key:0},ye={class:"mb-6"},be={key:0,class:"mb-6"},_e={class:"prose max-w-none mb-4"},ge=["innerHTML"],ve={class:"text-12px text-grayscale-500 mb-4"},fe={class:"mb-4"},he={class:"p-4 bg-grayscale-50 rounded-8px border"},we=["innerHTML"],ke={key:1},Ie={class:"prose max-w-none"},Ae=["innerHTML"],Oe={key:2,class:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-8px"},Se={class:"text-yellow-700 text-14px"},Me={key:0,class:"mb-6"},Pe={class:"grid gap-3"},Le=["href"],Te={key:1,class:"mb-6"},Ve={class:"grid gap-4"},Ne={class:"font-medium text-grayscale-600 mb-2"},Ce=["href"],He={key:0,class:"text-12px text-grayscale-400"},Re={class:"border-t border-grayscale-200 pt-4"},Ue={class:"text-14px"},We={class:"mt-3 p-3 bg-grayscale-50 rounded-6px"},qe={class:"text-12px text-grayscale-600 whitespace-pre-wrap overflow-auto"},Be={class:"text-center mt-8"},De={__name:"per",setup(Ee){const c=p(""),a=p(null),i=p(!1),u=p(""),y=p("sonar"),x=p(!1),b=p("請將以下內容進行整理和總結，讓它更加簡潔明了："),R=[{value:"sonar",label:"Sonar"},{value:"sonar-pro",label:"Sonar Pro"},{value:"sonar-reasoning",label:"Sonar Reasoning"},{value:"sonar-reasoning-pro",label:"Sonar Reasoning Pro"}],w=async()=>{var m;if(!c.value.trim()){u.value="請輸入搜尋查詢";return}i.value=!0,u.value="",a.value=null;try{const s=await $fetch("/api/perplexity/search",{method:"POST",body:{query:c.value,model:y.value,refineWithOpenAI:x.value,refinePrompt:b.value}});a.value=s}catch(s){u.value=((m=s==null?void 0:s.data)==null?void 0:m.message)||(s==null?void 0:s.message)||"搜尋時發生錯誤",console.error("Search error:",s)}finally{i.value=!1}},U=()=>{a.value=null,u.value=""},W=m=>{m.key==="Enter"&&!i.value&&w()};return(m,s)=>{var k,I,A,O,S,M,P,L,T,V,N;const q=B;return l(),r("div",Q,[e("div",$,[s[17]||(s[17]=e("div",{class:"text-center mb-8"},[e("h1",{class:"text-32px font-bold text-grayscale-600 mb-4"}," Perplexity AI 搜尋 "),e("p",{class:"text-16px text-grayscale-500"}," 使用 Perplexity AI 進行智能搜尋，獲得準確且有引用來源的答案 ")],-1)),e("div",G,[e("div",X,[s[4]||(s[4]=e("label",{class:"block text-14px font-medium text-grayscale-600 mb-2"}," 選擇模型 ",-1)),_(e("select",{"onUpdate:modelValue":s[0]||(s[0]=o=>g(y)?y.value=o:null),class:"w-full md:w-auto px-3 py-2 border border-grayscale-300 rounded-6px focus:outline-none focus:ring-2 focus:ring-secondary-200"},[(l(),r(f,null,h(R,o=>e("option",{key:o.value,value:o.value},n(o.label),9,Y)),64))],512),[[E,t(y)]])]),e("div",Z,[e("div",ee,[_(e("input",{id:"refineWithOpenAI","onUpdate:modelValue":s[1]||(s[1]=o=>g(x)?x.value=o:null),type:"checkbox",class:"mr-2 h-4 w-4 text-secondary-200 focus:ring-secondary-200 border-grayscale-300 rounded"},null,512),[[F,t(x)]]),s[5]||(s[5]=e("label",{for:"refineWithOpenAI",class:"text-14px font-medium text-grayscale-600"}," 啟用 OpenAI 內容整理 ",-1))]),t(x)?(l(),r("div",se,[s[6]||(s[6]=e("label",{class:"block text-14px font-medium text-grayscale-600 mb-2"}," 整理指令 ",-1)),_(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=o=>g(b)?b.value=o:null),rows:"3",class:"w-full px-3 py-2 border border-grayscale-300 rounded-6px focus:outline-none focus:ring-2 focus:ring-secondary-200 text-14px",placeholder:"請輸入希望 OpenAI 如何整理內容的指令..."},null,512),[[C,t(b)]]),s[7]||(s[7]=e("p",{class:"text-12px text-grayscale-500 mt-1"}," 啟用後，Perplexity 回應將透過 OpenAI 進行進一步整理和優化 ",-1))])):d("",!0)]),e("div",te,[e("div",ae,[_(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>g(c)?c.value=o:null),type:"text",placeholder:"請輸入您的搜尋查詢...",class:"w-full px-4 py-3 border border-grayscale-300 rounded-8px focus:outline-none focus:ring-2 focus:ring-secondary-200 text-16px",disabled:t(i),onKeypress:W},null,40,oe),[[C,t(c)]])]),e("div",re,[e("button",{disabled:t(i)||!t(c).trim(),class:K(["button-primary-md flex items-center gap-2 whitespace-nowrap",{"opacity-50 cursor-not-allowed":t(i)||!t(c).trim()}]),onClick:w},[t(i)?(l(),r("span",ne,"⏳")):d("",!0),H(" "+n(t(i)?"搜尋中...":"搜尋"),1)],10,le),t(a)?(l(),r("button",{key:0,class:"button-secondary-md",onClick:U}," 清除 ")):d("",!0)])]),t(u)?(l(),r("div",de,[e("p",ie,n(t(u)),1)])):d("",!0)]),t(i)?(l(),r("div",ce,s[8]||(s[8]=[j('<div class="animate-pulse" data-v-f2071f84><div class="h-4 bg-grayscale-200 rounded mb-4" data-v-f2071f84></div><div class="h-4 bg-grayscale-200 rounded mb-4 w-3/4 mx-auto" data-v-f2071f84></div><div class="h-4 bg-grayscale-200 rounded w-1/2 mx-auto" data-v-f2071f84></div></div><p class="text-grayscale-500 mt-4" data-v-f2071f84>正在使用 AI 搜尋相關資訊...</p>',2)]))):d("",!0),t(a)&&!t(i)?(l(),r("div",pe,[e("div",ue,[s[9]||(s[9]=e("h2",{class:"text-20px font-bold text-grayscale-600 mb-2"},"搜尋結果",-1)),e("div",xe,[e("span",null,"模型: "+n(t(a).model),1),e("span",null,"用量: "+n((k=t(a).usage)==null?void 0:k.total_tokens)+" tokens",1),(I=t(a).usage)!=null&&I.num_search_queries?(l(),r("span",me," 搜尋次數: "+n(t(a).usage.num_search_queries),1)):d("",!0)])]),e("div",ye,[t(a).is_refined?(l(),r("div",be,[s[11]||(s[11]=e("h3",{class:"text-18px font-semibold text-grayscale-600 mb-3 flex items-center"},[e("span",{class:"mr-2"},"✨ OpenAI 整理後內容"),e("span",{class:"text-12px bg-secondary-100 text-secondary-600 px-2 py-1 rounded-full"}," 已優化 ")],-1)),e("div",_e,[e("div",{class:"text-16px leading-28px text-grayscale-600 whitespace-pre-wrap p-4 bg-gradient-to-r from-secondary-50 to-blue-50 rounded-8px border border-secondary-100",innerHTML:((A=t(a).refined_content)==null?void 0:A.replace(/\n/g,"<br>"))||""},null,8,ge)]),e("div",ve," OpenAI 處理用量: "+n(t(a).openai_tokens_used)+" tokens ",1),e("details",fe,[s[10]||(s[10]=e("summary",{class:"cursor-pointer text-14px text-grayscale-500 hover:text-grayscale-600 mb-2"}," 查看原始 Perplexity 回應 ",-1)),e("div",he,[e("div",{class:"text-14px leading-24px text-grayscale-600 whitespace-pre-wrap",innerHTML:((P=(M=(S=(O=t(a).choices)==null?void 0:O[0])==null?void 0:S.message)==null?void 0:M.content)==null?void 0:P.replace(/\n/g,"<br>"))||""},null,8,we)])])])):(l(),r("div",ke,[s[12]||(s[12]=e("h3",{class:"text-18px font-semibold text-grayscale-600 mb-3"}," AI 回應 ",-1)),e("div",Ie,[e("div",{class:"text-16px leading-28px text-grayscale-600 whitespace-pre-wrap",innerHTML:((N=(V=(T=(L=t(a).choices)==null?void 0:L[0])==null?void 0:T.message)==null?void 0:V.content)==null?void 0:N.replace(/\n/g,"<br>"))||""},null,8,Ae)])])),t(a).refine_error?(l(),r("div",Oe,[e("p",Se," ⚠️ "+n(t(a).refine_error),1)])):d("",!0)]),t(a).citations&&t(a).citations.length>0?(l(),r("div",Me,[s[13]||(s[13]=e("h3",{class:"text-18px font-semibold text-grayscale-600 mb-3"}," 引用來源 ",-1)),e("div",Pe,[(l(!0),r(f,null,h(t(a).citations,(o,v)=>(l(),r("div",{key:v,class:"p-3 bg-grayscale-100 rounded-8px"},[e("a",{href:o,target:"_blank",rel:"noopener noreferrer",class:"text-secondary-200 hover:text-secondary-100 text-14px break-all"},n(o),9,Le)]))),128))])])):d("",!0),t(a).search_results&&t(a).search_results.length>0?(l(),r("div",Te,[s[14]||(s[14]=e("h3",{class:"text-18px font-semibold text-grayscale-600 mb-3"}," 相關搜尋結果 ",-1)),e("div",Ve,[(l(!0),r(f,null,h(t(a).search_results,(o,v)=>(l(),r("div",{key:v,class:"p-4 border border-grayscale-200 rounded-8px hover:shadow-sm transition-shadow"},[e("h4",Ne,n(o.title),1),e("a",{href:o.url,target:"_blank",rel:"noopener noreferrer",class:"text-secondary-200 hover:text-secondary-100 text-14px break-all mb-1 block"},n(o.url),9,Ce),o.date?(l(),r("p",He,n(o.date),1)):d("",!0)]))),128))])])):d("",!0),e("div",Re,[e("details",Ue,[s[15]||(s[15]=e("summary",{class:"cursor-pointer text-grayscale-500 hover:text-grayscale-600"}," 詳細資訊 ",-1)),e("div",We,[e("pre",qe,n(JSON.stringify(t(a),null,2)),1)])])])])):d("",!0),e("div",Be,[z(q,{to:"/",class:"text-secondary-200 hover:text-secondary-100 text-16px"},{default:J(()=>s[16]||(s[16]=[H(" ← 返回首頁 ")])),_:1,__:[16]})])])])}}},je=D(De,[["__scopeId","data-v-f2071f84"]]);export{je as default};
